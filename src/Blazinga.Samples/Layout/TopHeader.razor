@inject ThemeService ThemeService
@inject IJSRuntime JS

<div class="top-row px-4">
    <ul class="navbar-nav flex-row flex-wrap ms-md-auto">
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle d-flex align-items-center" style="text-decoration: none;" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-@GetThemeCssClass()"></i>
            </a>
            <ul class="dropdown-menu dropdown-menu-end">
                <li>
                    <button class="dropdown-item d-flex align-items-center" @onclick="() => SetThemeLightAsync()">
                        <i class="bi bi-sun-fill me-2"></i> Light
                    </button>
                </li>
                <li>
                    <button class="dropdown-item d-flex align-items-center" @onclick="() => SetThemeDarkAsync()">
                        <i class="bi bi-moon-stars-fill me-2"></i> Dark
                    </button>
                </li>
                <li>
                    <button class="dropdown-item d-flex align-items-center" @onclick="() => SetThemeAutoAsync()">
                        <i class="bi bi-circle-half me-2"></i> Auto
                    </button>
                </li>
            </ul>
        </li>
    </ul>
</div>

@code {
    private string GetThemeCssClass()
    {
        return ThemeService.CurrentTheme switch
        {
            "light" => "sun-fill",
            "dark" => "moon-stars-fill",
            _ => "circle-half"
        };
    }

    private async Task SetThemeAsync(string theme)
    {
        await ThemeService.SetThemeAsync(theme);
        StateHasChanged(); // update icon if needed
    }
    private async Task SetThemeLightAsync()
    {
        await SetThemeAsync("light");
    }
    private async Task SetThemeDarkAsync()
    {
        await SetThemeAsync("dark");
    }
    private async Task SetThemeAutoAsync()
    {
        await SetThemeAsync("auto");
    }
}
